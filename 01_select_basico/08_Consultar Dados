üîç Se√ß√£o 7: Como Consultar Dados (SQL)
29. ORDER BY + Dicas
Ordena os resultados por uma ou mais colunas.

Padr√£o: ASC (crescente). Use DESC para decrescente.

Exemplo:

sql
Copiar
Editar
SELECT * FROM TB_PRODUTO ORDER BY Preco DESC;
30. Estruturas Condicionais WHERE
Filtra os dados com base em uma condi√ß√£o.

Exemplo:

sql
Copiar
Editar
SELECT * FROM TB_CLIENTE WHERE NomeCompleto LIKE 'A%';
31. Diretiva LIKE
Filtragem com padr√µes.

% representa qualquer sequ√™ncia de caracteres.

_ representa um √∫nico caractere.

Exemplo:

sql
Copiar
Editar
SELECT * FROM TB_CLIENTE WHERE NomeCompleto LIKE '_n%';
32. Operadores Relacionais e BETWEEN
=, >, <, >=, <=, <>, !=

BETWEEN define intervalos (inclusive).

Exemplo:

sql
Copiar
Editar
SELECT * FROM TB_PRODUTO WHERE Preco BETWEEN 50 AND 100;
33. Conceito de NULL
NULL representa valor desconhecido/ausente.

= NULL n√£o funciona ‚Üí use IS NULL ou IS NOT NULL.

Exemplo:

sql
Copiar
Editar
SELECT * FROM TB_FUNCIONARIO WHERE DataNascimento IS NULL;
34. IN, NOT IN e valores nulos
IN verifica se um valor est√° dentro de uma lista.

Cuidado com NULL em subconsultas.

Exemplo:

sql
Copiar
Editar
SELECT * FROM TB_PRODUTO WHERE CategoriaId IN (1, 2, 3);
35. Unindo Consultas (UNION, UNION ALL)
UNION remove duplicatas; UNION ALL mant√©m tudo.

As colunas devem ter o mesmo n√∫mero e tipos compat√≠veis.

Exemplo:

sql
Copiar
Editar
SELECT NomeCompleto FROM TB_CLIENTE
UNION
SELECT NomeCompleto FROM TB_FUNCIONARIO;
36. Como excluir tabelas e bancos de dados
Remove estruturas permanentemente.

Exemplo:

sql
Copiar
Editar
DROP TABLE TB_ENDERECO;
DROP DATABASE EMPRESA_DB;
37. INTERSECT e EXCEPT
INTERSECT: interse√ß√£o entre dois SELECTs.

EXCEPT: valores da primeira consulta que n√£o est√£o na segunda.

Exemplo:

sql
Copiar
Editar
SELECT NomeCompleto FROM TB_CLIENTE
INTERSECT
SELECT NomeCompleto FROM TB_FUNCIONARIO;

üß© Complemento: TOP ... WITH TIES
üìå O que √©?
O WITH TIES √© usado junto com TOP e ORDER BY para incluir todos os registros empatados no valor de ordena√ß√£o, mesmo que isso ultrapasse o n√∫mero definido no TOP.

üõ†Ô∏è Sintaxe:
sql
Copiar
Editar
SELECT TOP (n) WITH TIES *
FROM NomeTabela
ORDER BY ColunaOrdenada;
üß† Por que usar?
Quando m√∫ltiplos registros t√™m o mesmo valor na coluna de ordena√ß√£o, o SQL Server considera todos eles ‚Äúempatados‚Äù e os inclui no resultado.

üéØ Exemplo:
sql
Copiar
Editar
SELECT TOP 3 WITH TIES *
FROM TB_PRODUTO
ORDER BY Preco DESC;
üü¢ Isso trar√° os 3 produtos com maior pre√ßo e tamb√©m qualquer outro produto que tenha exatamente o mesmo pre√ßo que o terceiro maior.

‚ö†Ô∏è Regras importantes:
O ORDER BY √© obrigat√≥rio quando se usa WITH TIES.

Funciona apenas em SQL Server (n√£o compat√≠vel com todos os SGBDs).

üîπ TOP ... WITH TIES no SQL Server
‚úÖ O que √©?
A cl√°usula WITH TIES √© usada em conjunto com TOP e ORDER BY para garantir que todos os registros empatados no crit√©rio de ordena√ß√£o tamb√©m sejam inclu√≠dos no resultado ‚Äî mesmo que ultrapasse a quantidade definida no TOP.

üß™ Sintaxe:
sql
Copiar
Editar
SELECT TOP (n) WITH TIES *
FROM NomeTabela
ORDER BY ColunaOrdenada;
üìå Quando usar?
Use WITH TIES quando quiser garantir que todos os registros com o mesmo valor no crit√©rio de ordena√ß√£o (empatados) tamb√©m sejam retornados.

üìç Exemplo pr√°tico:
sql
Copiar
Editar
SELECT TOP 3 WITH TIES *
FROM TB_PRODUTO
ORDER BY Preco DESC;
‚úî Este comando ir√° retornar:

Os 3 produtos com maior pre√ßo

E quaisquer outros produtos que tenham o mesmo valor de pre√ßo do terceiro produto da lista.

‚ö†Ô∏è Observa√ß√µes:
ORDER BY √© obrigat√≥rio ao usar WITH TIES.

S√≥ √© suportado por alguns SGBDs, como o SQL Server.

Pode resultar em mais de N linhas, se houver empates.


Esses comandos s√£o usados para comparar os resultados de duas consultas SELECT e retornar:

INTERSECT ‚Üí apenas os registros que est√£o nas duas consultas (interse√ß√£o).

EXCEPT ‚Üí os registros que est√£o apenas na primeira consulta e n√£o est√£o na segunda.

‚úÖ Sintaxe Geral
sql
Copiar
Editar
SELECT coluna1, coluna2, ...
FROM tabela1
[...]
INTERSECT
SELECT coluna1, coluna2, ...
FROM tabela2;
sql
Copiar
Editar
SELECT coluna1, coluna2, ...
FROM tabela1
[...]
EXCEPT
SELECT coluna1, coluna2, ...
FROM tabela2;
üîç Regras importantes
Ambas as consultas devem ter o mesmo n√∫mero de colunas, com tipos de dados compat√≠veis e na mesma ordem.

INTERSECT e EXCEPT eliminam valores duplicados automaticamente, como DISTINCT.

üß™ Exemplo com INTERSECT
sql
Copiar
Editar
-- Clientes que fizeram pedidos e t√™m endere√ßo cadastrado
SELECT ClienteId
FROM TB_PEDIDO
INTERSECT
SELECT ClienteId
FROM TB_ENDERECO;
üîé Resultado: apenas os ClienteId que est√£o em ambas as tabelas.

üß™ Exemplo com EXCEPT
sql
Copiar
Editar
-- Produtos cadastrados que ainda n√£o foram vendidos
SELECT ProdutoId
FROM TB_PRODUTO
EXCEPT
SELECT ProdutoId
FROM TB_DETALHE_PEDIDO;
üîé Resultado: apenas os ProdutoId da primeira tabela que n√£o apareceram em vendas.

üìå Dica pr√°tica
Use INTERSECT e EXCEPT para auditorias, consist√™ncia de dados ou para comparar conjuntos com facilidade ‚Äî sem precisar de subqueries complexas ou JOINs com NOT EXISTS.

